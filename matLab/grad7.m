
bez_mat_1 = [
    1.0000, 0,       0,       0, ...
    0.9767, 0.0231,  0.0002,  0.0000, ...
    0.9539, 0.0454,  0.0007,  0.0000, ...
    0.9313, 0.0671,  0.0016,  0.0000, ...
    0.9091, 0.0880,  0.0028,  0.0000, ...
    0.8873, 0.1082,  0.0044,  0.0001, ...
    0.8659, 0.1278,  0.0063,  0.0001, ...
    0.8447, 0.1466,  0.0085,  0.0002, ...
    0.8240, 0.1648,  0.0110,  0.0002, ...
    0.8035, 0.1823,  0.0138,  0.0003, ...
    0.7835, 0.1992,  0.0169,  0.0005, ...
    0.7637, 0.2154,  0.0203,  0.0006, ...
    0.7443, 0.2310,  0.0239,  0.0008, ...
    0.7252, 0.2459,  0.0278,  0.0010, ...
    0.7065, 0.2603,  0.0320,  0.0013, ...
    0.6880, 0.2740,  0.0364,  0.0016, ...
    0.6699, 0.2871,  0.0410,  0.0020, ...
    0.6521, 0.2996,  0.0459,  0.0023, ...
    0.6347, 0.3116,  0.0510,  0.0028, ...
    0.6175, 0.3229,  0.0563,  0.0033, ...
    0.6007, 0.3337,  0.0618,  0.0038, ...
    0.5841, 0.3439,  0.0675,  0.0044, ...
    0.5679, 0.3536,  0.0734,  0.0051, ...
    0.5520, 0.3627,  0.0795,  0.0058, ...
    0.5364, 0.3713,  0.0857,  0.0066, ...
    0.5211, 0.3794,  0.0921,  0.0075, ...
    0.5060, 0.3870,  0.0986,  0.0084, ...
    0.4913, 0.3940,  0.1053,  0.0094, ...
    0.4768, 0.4005,  0.1122,  0.0105, ...
    0.4627, 0.4066,  0.1191,  0.0116, ...
    0.4488, 0.4122,  0.1262,  0.0129, ...
    0.4352, 0.4173,  0.1333,  0.0142, ...
    0.4219, 0.4219,  0.1406,  0.0156, ...
    0.4088, 0.4260,  0.1480,  0.0171, ...
    0.3961, 0.4298,  0.1554,  0.0187, ...
    0.3835, 0.4330,  0.1630,  0.0204, ...
    0.3713, 0.4359,  0.1706,  0.0222, ...
    0.3593, 0.4383,  0.1782,  0.0242, ...
    0.3476, 0.4403,  0.1859,  0.0262, ...
    0.3362, 0.4419,  0.1936,  0.0283, ...
    0.3250, 0.4431,  0.2014,  0.0305, ...
    0.3140, 0.4439,  0.2092,  0.0329, ...
     0.3033, 0.4444,  0.2170,  0.0353, ...
    0.2928, 0.4444,  0.2248,  0.0379, ...
    0.2826, 0.4441,  0.2326,  0.0406, ...
    0.2726, 0.4435,  0.2404,  0.0435, ...
    0.2629, 0.4425,  0.2482,  0.0464, ...
    0.2534, 0.4411,  0.2560,  0.0495, ...
    0.2441, 0.4395,  0.2637,  0.0527, ...
    0.2351, 0.4375,  0.2713,  0.0561, ...
    0.2263, 0.4352,  0.2789,  0.0596, ...
    0.2177, 0.4326,  0.2865,  0.0633, ...
    0.2093, 0.4297,  0.2940,  0.0670, ...
    0.2012, 0.4265,  0.3014,  0.0710, ...
    0.1932, 0.4230,  0.3087,  0.0751, ...
    0.1855, 0.4193,  0.3159,  0.0793, ...
    0.1780, 0.4153,  0.3230,  0.0837, ...
    0.1707, 0.4110,  0.3300,  0.0883, ...
    0.1636, 0.4066,  0.3369,  0.0930, ...
    0.1566, 0.4018,  0.3436,  0.0979, ...
    0.1499, 0.3969,  0.3502,  0.1030, ...
    0.1434, 0.3917,  0.3566,  0.1082, ...
    0.1371, 0.3863,  0.3629,  0.1136, ...
    0.1310, 0.3808,  0.3691,  0.1192, ...
    0.1250, 0.3750,  0.3750,  0.1250, ...
    0.1192, 0.3691,  0.3808,  0.1310, ...
    0.1136, 0.3629,  0.3863,  0.1371, ...
    0.1082, 0.3566,  0.3917,  0.1434, ...
    0.1030, 0.3502,  0.3969,  0.1499, ...
    0.0979, 0.3436,  0.4018,  0.1566, ...
    0.0930, 0.3369,  0.4066,  0.1636, ...
    0.0883, 0.3300,  0.4110,  0.1707, ...
    0.0837, 0.3230,  0.4153,  0.1780, ...
    0.0793, 0.3159,  0.4193,  0.1855, ...
    0.0751, 0.3087,  0.4230,  0.1932, ...
    0.0710, 0.3014,  0.4265,  0.2012, ...
    0.0670, 0.2940,  0.4297,  0.2093, ...
    0.0633, 0.2865,  0.4326,  0.2177, ...
    0.0596, 0.2789,  0.4352,  0.2263, ...
    0.0561, 0.2713,  0.4375,  0.2351, ...
    0.0527, 0.2637,  0.4395,  0.2441, ...
    0.0495, 0.2560,  0.4411,  0.2534, ...
    0.0464, 0.2482,  0.4425,  0.2629, ...
    0.0435, 0.2404,  0.4435,  0.2726, ...
    0.0406, 0.2326,  0.4441,  0.2826, ...
    0.0379, 0.2248,  0.4444,  0.2928, ...
    0.0353, 0.2170,  0.4444,  0.3033, ...
    0.0329, 0.2092,  0.4439,  0.3140, ...
    0.0305, 0.2014,  0.4431,  0.3250, ...
    0.0283, 0.1936,  0.4419,  0.3362, ...
    0.0262, 0.1859,  0.4403,  0.3476, ...
    0.0242, 0.1782,  0.4383,  0.3593, ...
    0.0222, 0.1706,  0.4359,  0.3713, ...
    0.0204, 0.1630,  0.4330,  0.3835, ...
    0.0187, 0.1554,  0.4298,  0.3961, ...
    0.0171, 0.1480,  0.4260,  0.4088, ...
    0.0156, 0.1406,  0.4219,  0.4219, ...
    0.0142, 0.1333,  0.4173,  0.4352, ...
    0.0129, 0.1262,  0.4122,  0.4488, ...
    0.0116, 0.1191,  0.4066,  0.4627, ...
    0.0105, 0.1122,  0.4005,  0.4768, ...
    0.0094, 0.1053,  0.3940,  0.4913, ...
    0.0084, 0.0986,  0.3870,  0.5060, ...
    0.0075, 0.0921,  0.3794,  0.5211, ...
    0.0066, 0.0857,  0.3713,  0.5364, ...
    0.0058, 0.0795,  0.3627,  0.5520, ...
    0.0051, 0.0734,  0.3536,  0.5679, ...
    0.0044, 0.0675,  0.3439,  0.5841, ...
    0.0038, 0.0618,  0.3337,  0.6007, ...
    0.0033, 0.0563,  0.3229,  0.6175, ...
    0.0028, 0.0510,  0.3116,  0.6347, ...
    0.0023, 0.0459,  0.2996,  0.6521, ...
    0.0020, 0.0410,  0.2871,  0.6699, ...
    0.0016, 0.0364,  0.2740,  0.6880, ...
    0.0013, 0.0320,  0.2603,  0.7065, ...
    0.0010, 0.0278,  0.2459,  0.7252, ...
    0.0008, 0.0239,  0.2310,  0.7443, ...
    0.0006, 0.0203,  0.2154,  0.7637, ...
    0.0005, 0.0169,  0.1992,  0.7835, ...
    0.0003, 0.0138,  0.1823,  0.8035, ...
    0.0002, 0.0110,  0.1648,  0.8240, ...
    0.0002, 0.0085,  0.1466,  0.8447, ...
    0.0001, 0.0063,  0.1278,  0.8659, ...
    0.0001, 0.0044,  0.1082,  0.8873, ...
    0.0000, 0.0028,  0.0880,  0.9091, ...
    0.0000, 0.0016,  0.0671,  0.9313, ...
    0.0000, 0.0007,  0.0454,  0.9539, ...
    0.0000, 0.0002,  0.0231,  0.9767, ...
    0,      0,       0,       1.0000
];
bez_mat_1 = reshape(bez_mat_1, 129, 4);
d = [1, 1; 2, 3; 4, 2; 5, 5];
deg = 3;
stop = -4;
t = [0; 0.19264241879812793; 0.6540036986197189; 1];
bez_mat = [
  1, 0, 0, 0;
  0.5262568758056447, 0.37670816435547827, 0.08988578747772558, 0.007149172361151451;
  0.041420407662324785, 0.23487909871952867, 0.4439694837148117, 0.2797310099033348;
  0, 0, 0, 1
];

P = bez_mat \ d; 
disp(P);

y = bez_mat * P;
t1 = [0:1/128:1]' ;
y1 = bez_mat_1 * P;


